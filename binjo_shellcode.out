#
# Shellcode detector
#

MAX_LEGIT_INSTRUCTION_LOG_SIZE : 300

Executed before
0x004C985A::Foxit Reader.exe  55                      push ebp
0x004C985B::Foxit Reader.exe  8B EC                   mov ebp, esp
0x004C985D::Foxit Reader.exe  6A FF                   push 0xffffffff
0x004C985F::Foxit Reader.exe  68 D8 21 A1 00          push 0xa121d8
0x004C9864::Foxit Reader.exe  68 0C AC 4C 00          push 0x4cac0c
0x004C9869::Foxit Reader.exe  64 A1 00 00 00 00       mov eax, dword ptr fs:[0x0]
0x004C986F::Foxit Reader.exe  50                      push eax
0x004C9870::Foxit Reader.exe  64 89 25 00 00 00 00    mov dword ptr fs:[0x0], esp
0x004C9877::Foxit Reader.exe  83 EC 58                sub esp, 0x58
0x004C987A::Foxit Reader.exe  53                      push ebx
0x004C987B::Foxit Reader.exe  56                      push esi
0x004C987C::Foxit Reader.exe  57                      push edi
0x004C987D::Foxit Reader.exe  89 65 E8                mov dword ptr [ebp-0x18], esp
0x004C9880::Foxit Reader.exe  FF 15 84 D5 9F 00       call dword ptr [0x9fd584]
0x004C9886::Foxit Reader.exe  33 D2                   xor edx, edx
0x004C9888::Foxit Reader.exe  8A D4                   mov dl, ah
0x004C988A::Foxit Reader.exe  89 15 48 60 CB 00       mov dword ptr [0xcb6048], edx
0x004C9890::Foxit Reader.exe  8B C8                   mov ecx, eax
0x004C9892::Foxit Reader.exe  81 E1 FF 00 00 00       and ecx, 0xff
0x004C9898::Foxit Reader.exe  89 0D 44 60 CB 00       mov dword ptr [0xcb6044], ecx
0x004C989E::Foxit Reader.exe  C1 E1 08                shl ecx, 0x8
0x004C98A1::Foxit Reader.exe  03 CA                   add ecx, edx
0x004C98A3::Foxit Reader.exe  89 0D 40 60 CB 00       mov dword ptr [0xcb6040], ecx
0x004C98A9::Foxit Reader.exe  C1 E8 10                shr eax, 0x10
0x004C98AC::Foxit Reader.exe  A3 3C 60 CB 00          mov dword ptr [0xcb603c], eax
0x004C98B1::Foxit Reader.exe  6A 01                   push 0x1
0x004C98B3::Foxit Reader.exe  E8 E9 57 00 00          call 0x4cf0a1 -> unnamedImageEntryPoint
0x004CF0A1::Foxit Reader.exe  33 C0                   xor eax, eax
0x004CF0A3::Foxit Reader.exe  6A 00                   push 0x0
0x004CF0A5::Foxit Reader.exe  39 44 24 08             cmp dword ptr [esp+0x8], eax
0x004CF0A9::Foxit Reader.exe  68 00 10 00 00          push 0x1000
0x004CF0AE::Foxit Reader.exe  0F 94 C0                setz al
0x004CF0B1::Foxit Reader.exe  50                      push eax
0x004CF0B2::Foxit Reader.exe  FF 15 BC D3 9F 00       call dword ptr [0x9fd3bc]
0x004CF0B8::Foxit Reader.exe  85 C0                   test eax, eax
0x004CF0BA::Foxit Reader.exe  A3 A8 FF CC 00          mov dword ptr [0xccffa8], eax
0x004CF0BF::Foxit Reader.exe  74 36                   jz 0x4cf0f7
0x004CF0C1::Foxit Reader.exe  E8 93 FE FF FF          call 0x4cef59 -> unnamedImageEntryPoint
0x004CEF59::Foxit Reader.exe  55                      push ebp
0x004CEF5A::Foxit Reader.exe  8B EC                   mov ebp, esp
0x004CEF5C::Foxit Reader.exe  B8 2C 12 00 00          mov eax, 0x122c
0x004CEF61::Foxit Reader.exe  E8 7A BF FF FF          call 0x4caee0 -> unnamedImageEntryPoint
0x004CAEE0::Foxit Reader.exe  51                      push ecx
0x004CAEE1::Foxit Reader.exe  3D 00 10 00 00          cmp eax, 0x1000
0x004CAEE6::Foxit Reader.exe  8D 4C 24 08             lea ecx, ptr [esp+0x8]
0x004CAEEA::Foxit Reader.exe  72 14                   jb 0x4caf00
0x004CAEEC::Foxit Reader.exe  81 E9 00 10 00 00       sub ecx, 0x1000
0x004CAEF2::Foxit Reader.exe  2D 00 10 00 00          sub eax, 0x1000
0x004CAEF7::Foxit Reader.exe  85 01                   test dword ptr [ecx], eax
0x004CAEF9::Foxit Reader.exe  3D 00 10 00 00          cmp eax, 0x1000
0x004CAEFE::Foxit Reader.exe  73 EC                   jnb 0x4caeec
0x004CAF00::Foxit Reader.exe  2B C8                   sub ecx, eax
0x004CAF02::Foxit Reader.exe  8B C4                   mov eax, esp
0x004CAF04::Foxit Reader.exe  85 01                   test dword ptr [ecx], eax
0x004CAF06::Foxit Reader.exe  8B E1                   mov esp, ecx
0x004CAF08::Foxit Reader.exe  8B 08                   mov ecx, dword ptr [eax]
0x004CAF0A::Foxit Reader.exe  8B 40 04                mov eax, dword ptr [eax+0x4]
0x004CAF0D::Foxit Reader.exe  50                      push eax
0x004CAF0E::Foxit Reader.exe  C3                      ret 
0x004CEF66::Foxit Reader.exe  8D 85 68 FF FF FF       lea eax, ptr [ebp-0x98]
0x004CEF6C::Foxit Reader.exe  53                      push ebx
0x004CEF6D::Foxit Reader.exe  50                      push eax
0x004CEF6E::Foxit Reader.exe  C7 85 68 FF FF FF 94 00 00 00 mov dword ptr [ebp-0x98], 0x94
0x004CEF78::Foxit Reader.exe  FF 15 C4 D3 9F 00       call dword ptr [0x9fd3c4]
0x004CEF7E::Foxit Reader.exe  85 C0                   test eax, eax
0x004CEF80::Foxit Reader.exe  74 1A                   jz 0x4cef9c
0x004CEF82::Foxit Reader.exe  83 BD 78 FF FF FF 02    cmp dword ptr [ebp-0x88], 0x2
0x004CEF89::Foxit Reader.exe  75 11                   jnz 0x4cef9c
0x004CEF8B::Foxit Reader.exe  83 BD 6C FF FF FF 05    cmp dword ptr [ebp-0x94], 0x5
0x004CEF92::Foxit Reader.exe  72 08                   jb 0x4cef9c
0x004CEF94::Foxit Reader.exe  6A 01                   push 0x1
0x004CEF96::Foxit Reader.exe  58                      pop eax
0x004CEF97::Foxit Reader.exe  E9 02 01 00 00          jmp 0x4cf09e
0x004CF09E::Foxit Reader.exe  5B                      pop ebx
0x004CF09F::Foxit Reader.exe  C9                      leave 
0x004CF0A0::Foxit Reader.exe  C3                      ret 
0x004CF0C6::Foxit Reader.exe  83 F8 03                cmp eax, 0x3
0x004CF0C9::Foxit Reader.exe  A3 AC FF CC 00          mov dword ptr [0xccffac], eax
0x004CF0CE::Foxit Reader.exe  75 0D                   jnz 0x4cf0dd
0x004CF0D0::Foxit Reader.exe  68 F8 03 00 00          push 0x3f8
0x004CF0D5::Foxit Reader.exe  E8 5E 10 00 00          call 0x4d0138 -> unnamedImageEntryPoint

Shellcode:
0x541F0790::  55                      push ebp
0x541F0791::  8B EC                   mov ebp, esp
0x541F0793::  56                      push esi
0x541F0794::  8B 75 10                mov esi, dword ptr [ebp+0x10]
Executed before
0x004CF0DD::Foxit Reader.exe  83 F8 02                cmp eax, 0x2

Shellcode:
0x541F0797::  57                      push edi
Executed before
0x004CF0E0::Foxit Reader.exe  75 18                   jnz 0x4cf0fa

Shellcode:
0x541F0798::  8B 7D 0C                mov edi, dword ptr [ebp+0xc]
0x541F079B::  83 FF 01                cmp edi, 0x1
Executed before
0x004CF0E2::Foxit Reader.exe  E8 98 1B 00 00          call 0x4d0c7f -> unnamedImageEntryPoint

Shellcode:
0x541F079E::  75 19                   jnz 0x541f07b9
0x541F07B9::  83 FF 02                cmp edi, 0x2
0x541F07BC::  74 1E                   jz 0x541f07dc
Executed before
0x004CF0FA::Foxit Reader.exe  6A 01                   push 0x1
0x004CF0FC::Foxit Reader.exe  58                      pop eax
0x004CF0FD::Foxit Reader.exe  C3                      ret 

Shellcode:
0x541F07DC::  80 3D 3C 8B 48 54 00    cmp byte ptr [0x54488b3c], 0x0
0x541F07E3::  75 56                   jnz 0x541f083b
Executed before
0x004C98B8::Foxit Reader.exe  59                      pop ecx
0x004C98B9::Foxit Reader.exe  85 C0                   test eax, eax
0x004C98BB::Foxit Reader.exe  75 08                   jnz 0x4c98c5
0x004C98BD::Foxit Reader.exe  6A 1C                   push 0x1c
0x004C98BF::Foxit Reader.exe  E8 C2 00 00 00          call 0x4c9986 -> unnamedImageEntryPoint
0x004C98C5::Foxit Reader.exe  E8 F4 54 00 00          call 0x4cedbe -> unnamedImageEntryPoint

Shellcode:
0x541F083B::  5F                      pop edi
0x541F083C::  B0 01                   mov al, 0x1
0x541F083E::  5E                      pop esi
0x541F083F::  5D                      pop ebp
0x541F0840::  C2 0C 00                ret 0xc
Executed before
0x004CEDBE::Foxit Reader.exe  56                      push esi
0x004CEDBF::Foxit Reader.exe  E8 88 25 00 00          call 0x4d134c -> unnamedImageEntryPoint

Shellcode:
0x5500BC70::  55                      push ebp
0x5500BC71::  8B EC                   mov ebp, esp
0x5500BC73::  56                      push esi
0x5500BC74::  8B 75 10                mov esi, dword ptr [ebp+0x10]
0x5500BC77::  57                      push edi
0x5500BC78::  8B 7D 0C                mov edi, dword ptr [ebp+0xc]
0x5500BC7B::  83 FF 01                cmp edi, 0x1
0x5500BC7E::  75 19                   jnz 0x5500bc99
Executed before
0x004D134C::Foxit Reader.exe  56                      push esi
0x004D134D::Foxit Reader.exe  8B 35 94 D5 9F 00       mov esi, dword ptr [0x9fd594]
0x004D1353::Foxit Reader.exe  FF 35 8C 1D BA 00       push dword ptr [0xba1d8c]
0x004D1359::Foxit Reader.exe  FF D6                   call esi

Shellcode:
0x5500BC99::  83 FF 02                cmp edi, 0x2
0x5500BC9C::  74 1E                   jz 0x5500bcbc
0x5500BCBC::  80 3D 38 85 1D 55 00    cmp byte ptr [0x551d8538], 0x0
0x5500BCC3::  75 56                   jnz 0x5500bd1b
Executed before
0x004D135B::Foxit Reader.exe  FF 35 7C 1D BA 00       push dword ptr [0xba1d7c]
0x004D1361::Foxit Reader.exe  FF D6                   call esi

Shellcode:
0x5500BD1B::  5F                      pop edi
0x5500BD1C::  B0 01                   mov al, 0x1
0x5500BD1E::  5E                      pop esi
0x5500BD1F::  5D                      pop ebp
0x5500BD20::  C2 0C 00                ret 0xc

-- eof --
